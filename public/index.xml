<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Chuliang Xiao on Chuliang Xiao</title>
    <link>/</link>
    <description>Recent content in Chuliang Xiao on Chuliang Xiao</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2018 Chuliang Xiao</copyright>
    <lastBuildDate>Sun, 15 Oct 2017 00:00:00 -0400</lastBuildDate>
    <atom:link href="/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>US State and County Choropleth Map (Heatmap)</title>
      <link>/post/us-state-and-county-choropleth-map-heatmap/</link>
      <pubDate>Fri, 04 May 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/us-state-and-county-choropleth-map-heatmap/</guid>
      <description>&lt;p&gt;In this &lt;a href=&#34;https://twitter.com/search?q=%23TidyTuesday&amp;amp;src=tyah&#34;&gt;#TidyTuesday&lt;/a&gt; post, I try to show an example of putting together six common geographic visualization methods of &lt;a href=&#34;https://en.wikipedia.org/wiki/Heat_map&#34;&gt;&lt;strong&gt;heat map&lt;/strong&gt;&lt;/a&gt; or &lt;a href=&#34;https://en.wikipedia.org/wiki/Choropleth_map&#34;&gt;&lt;strong&gt;choropleth map&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Code is available on &lt;a href=&#34;https://github.com/ChuliangXiao/tidytuesday/tree/master/Week05&#34;&gt;GitHUB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Counties
&lt;ul&gt;
&lt;li&gt;Map data from &lt;code&gt;mpas&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/ChuliangXiao/tidytuesday/blob/master/Week05/county_maps.Rmd&#34;&gt;Corrected&lt;/a&gt; to match with American Community Survey (ACS)&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;COUNS (48 states an DC)&lt;br /&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Map data from &lt;code&gt;albersusa&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;50 States and DC&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Using &lt;code&gt;R6&lt;/code&gt; class &lt;code&gt;choroplethr&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;50 States and DC&lt;br /&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;States
&lt;ul&gt;
&lt;li&gt;Map data from &lt;code&gt;fiftyster&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;50 States and DC&lt;br /&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;State bins from &lt;code&gt;statebins&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;50 States, DC and &lt;strong&gt;PR&lt;/strong&gt;&lt;br /&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;State hexbins from &lt;code&gt;geojsonion&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;50 States and DC&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;div id=&#34;week-5---county-level-american-community-survey-5-year-estimates-2015&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Week 5 - County-level American Community Survey (5-year estimates) 2015&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/rfordatascience/tidytuesday/blob/master/data/acs2015_county_data.csv&#34;&gt;RAW DATA&lt;/a&gt;&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://factfinder.census.gov/faces/nav/jsf/pages/index.xhtml&#34;&gt;DataSource: census.gov&lt;/a&gt;&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.kaggle.com/muonneutrino/us-census-demographic-data&#34;&gt;Kaggle source&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;counties-of-conus-with-data-from-maps&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Counties of &lt;a href=&#34;https://en.wikipedia.org/wiki/Contiguous_United_States&#34;&gt;CONUS&lt;/a&gt; with data from &lt;code&gt;maps&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/ChuliangXiao/tidytuesday/master/Week05/US_State_County_CONUS.png&#34; /&gt;
### Counties of 50 States and DC with data from &lt;code&gt;albersusa&lt;/code&gt;&lt;br /&gt;
&lt;img src=&#34;https://raw.githubusercontent.com/ChuliangXiao/tidytuesday/master/Week05/US_State_County_albers.png&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;counties-of-50-states-and-dc-using-choroplethr&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Counties of 50 States and DC using &lt;code&gt;choroplethr&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/ChuliangXiao/tidytuesday/master/Week05/US_State_County_choropleth.png&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;states-and-dc-using-fiftyster&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;50 States and DC using &lt;code&gt;fiftyster&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/ChuliangXiao/tidytuesday/master/Week05/US_State_State_fiftystater.png&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bins-of-50-states-dc-and-pr-using-statebins&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Bins of 50 States, DC and PR using &lt;code&gt;statebins&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/ChuliangXiao/tidytuesday/master/Week05/US_State_State_statebins.png&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;hexbins-of-50-states-and-dc-data-from-geojsonion&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Hexbins of 50 States and DC data from &lt;code&gt;geojsonion&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/ChuliangXiao/tidytuesday/master/Week05/US_State_State_geojsonio.png&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>R Spatial Data Analysis 4: stars</title>
      <link>/post/r-spatial-data-analysis-4-stars/</link>
      <pubDate>Fri, 06 Apr 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/r-spatial-data-analysis-4-stars/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://www.r-spatial.org/r/2018/03/22/stars2.html&#34; class=&#34;uri&#34;&gt;https://www.r-spatial.org/r/2018/03/22/stars2.html&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>R Spatial Data Analysis 3: Simple Features </title>
      <link>/post/r-spatial-data-analysis-3-simple-features/</link>
      <pubDate>Wed, 04 Apr 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/r-spatial-data-analysis-3-simple-features/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://www.r-spatial.org/r/2016/02/15/simple-features-for-r.html&#34; class=&#34;uri&#34;&gt;https://www.r-spatial.org/r/2016/02/15/simple-features-for-r.html&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>R Spatial Data Analysis 2: Spatial Class</title>
      <link>/post/r-spatial-data-analysis-2-spatial-class/</link>
      <pubDate>Mon, 02 Apr 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/r-spatial-data-analysis-2-spatial-class/</guid>
      <description>&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(sp)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;getClass(&amp;#39;Spatial&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Class &amp;quot;Spatial&amp;quot; [package &amp;quot;sp&amp;quot;]
## 
## Slots:
##                               
## Name:         bbox proj4string
## Class:      matrix         CRS
## 
## Known Subclasses: 
## Class &amp;quot;SpatialPoints&amp;quot;, directly
## Class &amp;quot;SpatialMultiPoints&amp;quot;, directly
## Class &amp;quot;SpatialGrid&amp;quot;, directly
## Class &amp;quot;SpatialLines&amp;quot;, directly
## Class &amp;quot;SpatialPolygons&amp;quot;, directly
## Class &amp;quot;SpatialPointsDataFrame&amp;quot;, by class &amp;quot;SpatialPoints&amp;quot;, distance 2
## Class &amp;quot;SpatialPixels&amp;quot;, by class &amp;quot;SpatialPoints&amp;quot;, distance 2
## Class &amp;quot;SpatialMultiPointsDataFrame&amp;quot;, by class &amp;quot;SpatialMultiPoints&amp;quot;, distance 2
## Class &amp;quot;SpatialGridDataFrame&amp;quot;, by class &amp;quot;SpatialGrid&amp;quot;, distance 2
## Class &amp;quot;SpatialLinesDataFrame&amp;quot;, by class &amp;quot;SpatialLines&amp;quot;, distance 2
## Class &amp;quot;SpatialPixelsDataFrame&amp;quot;, by class &amp;quot;SpatialPoints&amp;quot;, distance 3
## Class &amp;quot;SpatialPolygonsDataFrame&amp;quot;, by class &amp;quot;SpatialPolygons&amp;quot;, distance 2&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;shape-objects&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;Shape objects&lt;/h5&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;Without data&lt;/th&gt;
&lt;th&gt;With data&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Polygons&lt;/td&gt;
&lt;td&gt;SpatialPolygons&lt;/td&gt;
&lt;td&gt;SpatialPolygonsDataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Points&lt;/td&gt;
&lt;td&gt;SpatialPoints&lt;/td&gt;
&lt;td&gt;SpatialPointsDataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Lines&lt;/td&gt;
&lt;td&gt;SpatialLines&lt;/td&gt;
&lt;td&gt;SpatialLinesDataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Raster&lt;/td&gt;
&lt;td&gt;SpatialGrid&lt;/td&gt;
&lt;td&gt;SpatialGridDataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Raster&lt;/td&gt;
&lt;td&gt;SpatialPixels&lt;/td&gt;
&lt;td&gt;SpatialPixelsDataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Raster&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;RasterLayer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Raster&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;RasterBrick&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Raster&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;RasterStack&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>R Spatial Data Analysis 1: from Data to Spatial Data</title>
      <link>/post/r-spatial-data-analysis-1-from-data-to-spatial-data/</link>
      <pubDate>Sat, 31 Mar 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/r-spatial-data-analysis-1-from-data-to-spatial-data/</guid>
      <description>&lt;p&gt;As much as R is popular in data analysis, R becomes more and more favored in geospatial analysis and visualization.&lt;/p&gt;
&lt;p&gt;To introduce spatial data, let first start with comman data. Basic R data types: &lt;code&gt;vector&lt;/code&gt;, &lt;code&gt;factor&lt;/code&gt;, &lt;code&gt;matrix&lt;/code&gt;, &lt;code&gt;data.frame&lt;/code&gt;, and &lt;code&gt;list&lt;/code&gt;.&lt;/p&gt;
&lt;div id=&#34;data-and-plots&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Data and Plots&lt;/h3&gt;
&lt;p&gt;There are many ways to munipulate and visualize data in R, including, typically, the basic and the &lt;code&gt;tidyverse&lt;/code&gt; framework. Let’s warm up with plotting &lt;code&gt;data.frame&lt;/code&gt;.&lt;/p&gt;
&lt;div id=&#34;basic-plot&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;basic plot&lt;/h4&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;attach(mtcars)
par(mfrow = c(1,2))
plot(mpg, wt, main = &amp;quot;wt vs. mpg&amp;quot;)
hist(mpg)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-03-31-r-spatial-data-analysis-1-from-data-to-spatial-data_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;ggplot2&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;ggplot2&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
p1  &amp;lt;- ggplot(mtcars, aes(x = mpg, y = wt)) + 
  geom_point() +
  ggtitle(&amp;quot;wt vs. mpg&amp;quot;) +
  theme(plot.title = element_text(hjust = 0.5))
p2  &amp;lt;- ggplot(mtcars, aes(mpg)) +
  geom_histogram(binwidth = 5, color = &amp;#39;black&amp;#39;, fill = &amp;#39;white&amp;#39;) +
  ggtitle(&amp;quot;mpg Histogram&amp;quot;) +
  theme(plot.title = element_text(hjust = 0.5))  
library(grid)
library(gridExtra)
grid.arrange(p1, p2, ncol = 2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-03-31-r-spatial-data-analysis-1-from-data-to-spatial-data_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;div id=&#34;spatial-data-and-plots&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Spatial Data and Plots&lt;/h4&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Load a csv file as data.frame as usual
dfUS &amp;lt;- read.csv(&amp;quot;/Users/cxiao/Documents/Rmd/Station_US.csv&amp;quot;)
# Take a look at the data.frame
head(dfUS)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   Num Station      Lat       Lon Avail
## 1   1 4074950 45.19133 -88.73779     1
## 2   2 4177720 41.52899 -84.88253     1
## 3   3 4077630 44.89831 -88.84534     1
## 4   4 4109000 42.29428 -84.40427     1
## 5   5 4178000 41.38407 -84.80254     1
## 6   6 4180988 40.70275 -84.65022     1&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# A bounch of USGS gages with lations
dfUS$Station  &amp;lt;- paste0(&amp;quot;0&amp;quot;, dfUS$Station)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;How to transfer a data.frame to a spatial class?&lt;/p&gt;
&lt;div id=&#34;first-get-the-coordinates&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;First, get the coordinates&lt;/h5&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(sp)
coords  &amp;lt;- SpatialPoints(dfUS[, c(&amp;#39;Lon&amp;#39;, &amp;#39;Lat&amp;#39;)])&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s check the above variable&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;class(coords)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;SpatialPoints&amp;quot;
## attr(,&amp;quot;package&amp;quot;)
## [1] &amp;quot;sp&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;str(coords)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Formal class &amp;#39;SpatialPoints&amp;#39; [package &amp;quot;sp&amp;quot;] with 3 slots
##   ..@ coords     : num [1:392, 1:2] -88.7 -84.9 -88.8 -84.4 -84.8 ...
##   .. ..- attr(*, &amp;quot;dimnames&amp;quot;)=List of 2
##   .. .. ..$ : NULL
##   .. .. ..$ : chr [1:2] &amp;quot;Lon&amp;quot; &amp;quot;Lat&amp;quot;
##   ..@ bbox       : num [1:2, 1:2] -92.6 40.7 -74.5 47.5
##   .. ..- attr(*, &amp;quot;dimnames&amp;quot;)=List of 2
##   .. .. ..$ : chr [1:2] &amp;quot;Lon&amp;quot; &amp;quot;Lat&amp;quot;
##   .. .. ..$ : chr [1:2] &amp;quot;min&amp;quot; &amp;quot;max&amp;quot;
##   ..@ proj4string:Formal class &amp;#39;CRS&amp;#39; [package &amp;quot;sp&amp;quot;] with 1 slot
##   .. .. ..@ projargs: chr NA&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(coords)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## SpatialPoints:
##            Lon      Lat
## [1,] -88.73779 45.19133
## [2,] -84.88253 41.52899
## [3,] -88.84534 44.89831
## [4,] -84.40427 42.29428
## [5,] -84.80254 41.38407
## [6,] -84.65022 40.70275
## Coordinate Reference System (CRS) arguments: NA&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can see, it’s a SpatialPoints class, looking like data.frame, only with coordinates but with any meaningful data.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;second-assign-data-to-the-spatialpoints&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;Second, assign data to the SpatialPoints&lt;/h5&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;spUS  &amp;lt;- SpatialPointsDataFrame(coords, dfUS)
# Check the new variable
class(spUS)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;SpatialPointsDataFrame&amp;quot;
## attr(,&amp;quot;package&amp;quot;)
## [1] &amp;quot;sp&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;str(spUS)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Formal class &amp;#39;SpatialPointsDataFrame&amp;#39; [package &amp;quot;sp&amp;quot;] with 5 slots
##   ..@ data       :&amp;#39;data.frame&amp;#39;:  392 obs. of  5 variables:
##   .. ..$ Num    : int [1:392] 1 2 3 4 5 6 7 8 9 10 ...
##   .. ..$ Station: chr [1:392] &amp;quot;04074950&amp;quot; &amp;quot;04177720&amp;quot; &amp;quot;04077630&amp;quot; &amp;quot;04109000&amp;quot; ...
##   .. ..$ Lat    : num [1:392] 45.2 41.5 44.9 42.3 41.4 ...
##   .. ..$ Lon    : num [1:392] -88.7 -84.9 -88.8 -84.4 -84.8 ...
##   .. ..$ Avail  : int [1:392] 1 1 1 1 1 1 1 1 1 1 ...
##   ..@ coords.nrs : num(0) 
##   ..@ coords     : num [1:392, 1:2] -88.7 -84.9 -88.8 -84.4 -84.8 ...
##   .. ..- attr(*, &amp;quot;dimnames&amp;quot;)=List of 2
##   .. .. ..$ : NULL
##   .. .. ..$ : chr [1:2] &amp;quot;Lon&amp;quot; &amp;quot;Lat&amp;quot;
##   ..@ bbox       : num [1:2, 1:2] -92.6 40.7 -74.5 47.5
##   .. ..- attr(*, &amp;quot;dimnames&amp;quot;)=List of 2
##   .. .. ..$ : chr [1:2] &amp;quot;Lon&amp;quot; &amp;quot;Lat&amp;quot;
##   .. .. ..$ : chr [1:2] &amp;quot;min&amp;quot; &amp;quot;max&amp;quot;
##   ..@ proj4string:Formal class &amp;#39;CRS&amp;#39; [package &amp;quot;sp&amp;quot;] with 1 slot
##   .. .. ..@ projargs: chr NA&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(spUS)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-03-31-r-spatial-data-analysis-1-from-data-to-spatial-data_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;after-tmap-is-loaded&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;After &lt;code&gt;tmap&lt;/code&gt; is loaded&lt;/h5&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tmap)
spUS&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class       : SpatialPointsDataFrame 
## features    : 392 
## extent      : -92.63297, -74.54355, 40.70275, 47.48204  (xmin, xmax, ymin, ymax)
## coord. ref. : NA 
## variables   : 5
## names       : Num,          Station,      Lat,       Lon, Avail 
## min values  :   1,         04015330, 40.70275, -74.54355,     0 
## max values  : 392, 0441624088045601, 47.48204, -92.63297,     1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A Spatial class variable will not be entirely dumped out.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# try tmap::qtm
qtm(spUS)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-03-31-r-spatial-data-analysis-1-from-data-to-spatial-data_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;difference-between-data.frame-and-spatialpointsdataframe&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;Difference between &lt;code&gt;data.frame&lt;/code&gt; and &lt;code&gt;SpatialPointsDataFrame&lt;/code&gt;&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;data.frame&lt;/code&gt; uses &lt;code&gt;$&lt;/code&gt; to access its columns.
&lt;ul&gt;
&lt;li&gt;e.g. &lt;code&gt;dfUS$Station&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SpatialPointsDataFrame&lt;/code&gt; uses &lt;code&gt;@&lt;/code&gt; to access its four lists: &lt;code&gt;data&lt;/code&gt;, &lt;code&gt;coords.nrs&lt;/code&gt;, &lt;code&gt;coords&lt;/code&gt;, &lt;code&gt;bbox&lt;/code&gt; and &lt;code&gt;proj4string&lt;/code&gt;; while &lt;code&gt;$&lt;/code&gt; to its &lt;code&gt;data&lt;/code&gt; columns.
&lt;ul&gt;
&lt;li&gt;e.g. &lt;code&gt;spUS@data&lt;/code&gt;, then &lt;code&gt;spUS@data$Station&lt;/code&gt;, or simply &lt;code&gt;spUS$Station&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;another-quick-way&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;Another quick way&lt;/h5&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pnt1  &amp;lt;- dfUS
coordinates(pnt1) = ~ Lon + Lat&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;shape-objects&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;Shape objects&lt;/h5&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;Without data&lt;/th&gt;
&lt;th&gt;With data&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Polygons&lt;/td&gt;
&lt;td&gt;SpatialPolygons&lt;/td&gt;
&lt;td&gt;SpatialPolygonsDataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Points&lt;/td&gt;
&lt;td&gt;SpatialPoints&lt;/td&gt;
&lt;td&gt;SpatialPointsDataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Lines&lt;/td&gt;
&lt;td&gt;SpatialLines&lt;/td&gt;
&lt;td&gt;SpatialLinesDataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Raster&lt;/td&gt;
&lt;td&gt;SpatialGrid&lt;/td&gt;
&lt;td&gt;SpatialGridDataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Raster&lt;/td&gt;
&lt;td&gt;SpatialPixels&lt;/td&gt;
&lt;td&gt;SpatialPixelsDataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Raster&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;RasterLayer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Raster&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;RasterBrick&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Raster&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;RasterStack&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;reading&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Reading&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Tutorial: &lt;a href=&#34;https://github.com/Robinlovelace/Creating-maps-in-R&#34;&gt;Creating maps in R&lt;/a&gt; by Robin Lovelance and James Cheshire&lt;/li&gt;
&lt;li&gt;website &lt;a href=&#34;https://www.r-spatial.org&#34;&gt;r-spaital.org&lt;/a&gt; by Edzer Pebesma&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;CRAN Task View: &lt;a href=&#34;https://CRAN.R-project.org/view=Spatial&#34;&gt;Analysis of Spatial Data&lt;/a&gt; by Roger Bivand&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;packages&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Packages&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;rgdal&lt;/code&gt;: R’s interface to Geospatial Data Abstraction Library (GDAL)
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;rgdal::readOGR&lt;/code&gt;, to read OGR vector maps (e.g. shapfile) into Spatial objects&lt;br /&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;rgeos&lt;/code&gt;: R’s interface to the powerful vector processing library geos&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;maptools&lt;/code&gt;: provides various mapping functions&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tmap&lt;/code&gt;: a new packages for rapidly creating beautiful maps
&lt;ul&gt;
&lt;li&gt;An extenstion wrap of the basic &lt;code&gt;plot&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qtm&lt;/code&gt;, quick thematic map plot&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tm_shape&lt;/code&gt;, &lt;code&gt;tm_fill&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ggmap&lt;/code&gt;: extends the plotting package &lt;code&gt;ggplot2&lt;/code&gt; for maps
&lt;ul&gt;
&lt;li&gt;add a variaty of basemaps&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;leaflet&lt;/code&gt;: interactive map from its &lt;a href=&#34;http://leafletjs.com/&#34;&gt;JavaScript&lt;/a&gt;&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mapview&lt;/code&gt;: interactive viewing spatial data based on &lt;code&gt;leaflet&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Personally I like &lt;code&gt;mapview&lt;/code&gt;’s popup function, see &lt;a href=&#34;https://r-spatial.github.io/mapview/&#34;&gt;tutorial&lt;/a&gt;&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;It spports &lt;code&gt;sp&lt;/code&gt;, &lt;code&gt;raster&lt;/code&gt;, &lt;code&gt;sf&lt;/code&gt; and &lt;a href=&#34;https://cran.r-project.org/package=satellite&#34;&gt;&lt;code&gt;satellite&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div id=&#34;maptoolsreadshapespatial&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;maptools::readShapeSpatial&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;The use of &lt;code&gt;maptools::readShapeSpatial&lt;/code&gt; has been &lt;strong&gt;deprecated&lt;/strong&gt;. Use &lt;code&gt;rgdal::readOGR&lt;/code&gt; and &lt;code&gt;sf::st_read&lt;/code&gt; instead.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;beyond-sp-package&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Beyond &lt;code&gt;sp&lt;/code&gt; package&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sf&lt;/code&gt; &lt;a href=&#34;../r-spatial-data-analysis-3-simple-features&#34;&gt;simple feature package&lt;/a&gt;&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;star&lt;/code&gt; &lt;a href=&#34;../r-spatial-data-analysis-4-stars&#34;&gt;spatiotemporal didy arrays for R&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Comparison: sort, order and arrange</title>
      <link>/post/comparison-sort-order-and-arrange/</link>
      <pubDate>Wed, 28 Mar 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/comparison-sort-order-and-arrange/</guid>
      <description>&lt;ul&gt;
&lt;li&gt;&lt;h2 id=&#34;vector-or-factor&#34;&gt;&lt;strong&gt;vector&lt;/strong&gt; (or factor)&lt;/h2&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;(x &amp;lt;- swiss$Education[1:20])&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1] 12  9  5  7 15  7  7  8  7 13  6 12  7 12  5  2  8 28 20  9&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# sort the vector
sort(x)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1]  2  5  5  6  7  7  7  7  7  8  8  9  9 12 12 12 13 15 20 28&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# partial sorting
sort(x, partial = c(10, 15))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1]  2  5  5  7  7  7  7  6  7  8  8  9  9 12 12 12 13 28 20 15&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Partial sorting in R is different with that in &lt;a href=&#34;http://en.wikipedia.org/wiki/Partial_sorting&#34;&gt;Wikipedia&lt;/a&gt;. See &lt;a href=&#34;https://stackoverflow.com/a/23579512&#34;&gt;Stack Overflow&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;h2 id=&#34;data.frame&#34;&gt;&lt;strong&gt;data.frame&lt;/strong&gt;&lt;/h2&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;order&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(mtcars)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# sort by mpg
Rank1 &amp;lt;- mtcars[order(mtcars$mpg), ]
head(Rank1)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                      mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Cadillac Fleetwood  10.4   8  472 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental 10.4   8  460 215 3.00 5.424 17.82  0  0    3    4
## Camaro Z28          13.3   8  350 245 3.73 3.840 15.41  0  0    3    4
## Duster 360          14.3   8  360 245 3.21 3.570 15.84  0  0    3    4
## Chrysler Imperial   14.7   8  440 230 3.23 5.345 17.42  0  0    3    4
## Maserati Bora       15.0   8  301 335 3.54 3.570 14.60  0  1    5    8&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# sort by cyl, then by hp
Rank2 &amp;lt;- mtcars[order(mtcars$cyl, mtcars$hp), ]
head(Rank2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                 mpg cyl  disp hp drat    wt  qsec vs am gear carb
## Honda Civic    30.4   4  75.7 52 4.93 1.615 18.52  1  1    4    2
## Merc 240D      24.4   4 146.7 62 3.69 3.190 20.00  1  0    4    2
## Toyota Corolla 33.9   4  71.1 65 4.22 1.835 19.90  1  1    4    1
## Fiat 128       32.4   4  78.7 66 4.08 2.200 19.47  1  1    4    1
## Fiat X1-9      27.3   4  79.0 66 4.08 1.935 18.90  1  1    4    1
## Porsche 914-2  26.0   4 120.3 91 4.43 2.140 16.70  0  1    5    2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# reverse sort
Rank3 &amp;lt;- mtcars[order(-mtcars$cyl, mtcars$hp), ]
head(Rank3)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                    mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Dodge Challenger  15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## AMC Javelin       15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Pontiac Firebird  19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## Merc 450SE        16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## Merc 450SL        17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If data.frame mtcars is &lt;code&gt;attach()&lt;/code&gt;, then&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;attach(mtcars)
mpgRank &amp;lt;- mtcars[order(mpg), ]
head(mpgRank)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                      mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Cadillac Fleetwood  10.4   8  472 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental 10.4   8  460 215 3.00 5.424 17.82  0  0    3    4
## Camaro Z28          13.3   8  350 245 3.73 3.840 15.41  0  0    3    4
## Duster 360          14.3   8  360 245 3.21 3.570 15.84  0  0    3    4
## Chrysler Imperial   14.7   8  440 230 3.23 5.345 17.42  0  0    3    4
## Maserati Bora       15.0   8  301 335 3.54 3.570 14.60  0  1    5    8&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;dplyr::arrange&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;Rank4 &amp;lt;- arrange(mtcars, mpg)
head(Rank4)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## 1 10.4   8  472 205 2.93 5.250 17.98  0  0    3    4
## 2 10.4   8  460 215 3.00 5.424 17.82  0  0    3    4
## 3 13.3   8  350 245 3.73 3.840 15.41  0  0    3    4
## 4 14.3   8  360 245 3.21 3.570 15.84  0  0    3    4
## 5 14.7   8  440 230 3.23 5.345 17.42  0  0    3    4
## 6 15.0   8  301 335 3.54 3.570 14.60  0  1    5    8&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;Rank5 &amp;lt;- arrange(mtcars, cyl, hp)
head(Rank5)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    mpg cyl  disp hp drat    wt  qsec vs am gear carb
## 1 30.4   4  75.7 52 4.93 1.615 18.52  1  1    4    2
## 2 24.4   4 146.7 62 3.69 3.190 20.00  1  0    4    2
## 3 33.9   4  71.1 65 4.22 1.835 19.90  1  1    4    1
## 4 32.4   4  78.7 66 4.08 2.200 19.47  1  1    4    1
## 5 27.3   4  79.0 66 4.08 1.935 18.90  1  1    4    1
## 6 26.0   4 120.3 91 4.43 2.140 16.70  0  1    5    2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;Rank6 &amp;lt;- arrange(mtcars, -cyl, hp)
head(Rank6)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## 1 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## 2 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## 3 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## 4 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## 5 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## 6 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;difference between order and arrange
&lt;ul&gt;
&lt;li&gt;row names: &lt;code&gt;order&lt;/code&gt; keep the row names of mtcars, while not in &lt;code&gt;dplyr::arrange&lt;/code&gt;&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;efficency: &lt;code&gt;dplyr::arrange&lt;/code&gt; tends to be faster when there are lots of rows.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Refer to&lt;br /&gt;
1. &lt;a href=&#34;http://www.cookbook-r.com/Manipulating_data/Sorting/&#34;&gt;Cookbook for R&lt;/a&gt;&lt;br /&gt;
2. &lt;a href=&#34;https://www.statmethods.net/management/sorting.html&#34;&gt;Quick-R&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Comparison: transform, within and mutate</title>
      <link>/post/comparison-transform-within-and-mutate/</link>
      <pubDate>Sun, 25 Mar 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/comparison-transform-within-and-mutate/</guid>
      <description>&lt;p&gt;Here is another comparison between two basic functions &lt;code&gt;transform&lt;/code&gt; and &lt;code&gt;within&lt;/code&gt;, and a tidyverse function &lt;code&gt;dplyr::mutate&lt;/code&gt;. They all can be used for data munipulation, adding a new column to a data.frame.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(mtcars)  &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;one-variable&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;One variable&lt;/h3&gt;
&lt;p&gt;Calculate horse power per cylinder (&lt;code&gt;hp/cyl&lt;/code&gt;) and add it to &lt;code&gt;mtcars&lt;/code&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tmp1  &amp;lt;- transform(mtcars, hpc = round(hp / cyl))
head(tmp1)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb hpc
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4  18
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4  18
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1  23
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1  18
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2  22
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1  18&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tmp2 &amp;lt;- within(mtcars, {hpc &amp;lt;- round(hp / cyl)})
# tmp1 and tmp2 are identicial
head(tmp2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb hpc
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4  18
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4  18
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1  23
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1  18
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2  22
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1  18&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
tmp3 &amp;lt;- mutate(mtcars, hpc = round(hp / cyl))
# tmp3 is ALMOST the same as tmp1 and tmp2, except that row names are missed
head(tmp3)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    mpg cyl disp  hp drat    wt  qsec vs am gear carb hpc
## 1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4  18
## 2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4  18
## 3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1  23
## 4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1  18
## 5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2  22
## 6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1  18&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;two-variables&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;two variables&lt;/h3&gt;
&lt;p&gt;A variable created by &lt;code&gt;transform&lt;/code&gt; process cannot be used&lt;a href=&#34;#fn1&#34; class=&#34;footnoteRef&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;.&lt;br /&gt;
The example below fails.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;tmp1  &amp;lt;- transform(mtcars, hpc = round(hp / cyl), hpc1 = hpc + 1)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;While &lt;code&gt;within&lt;/code&gt; and &lt;code&gt;dplyr::mutate&lt;/code&gt; are OK&lt;a href=&#34;#fn2&#34; class=&#34;footnoteRef&#34; id=&#34;fnref2&#34;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tmp2 &amp;lt;- within(mtcars, {hpc  &amp;lt;- round(hp / cyl)
                        hpc1 &amp;lt;- hpc + 1 })
head(tmp2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb hpc1
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4   19
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4   19
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1   24
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1   19
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2   23
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1   19
##                   hpc
## Mazda RX4          18
## Mazda RX4 Wag      18
## Datsun 710         23
## Hornet 4 Drive     18
## Hornet Sportabout  22
## Valiant            18&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tmp3 &amp;lt;- mutate(mtcars, hpc = round(hp / cyl), hpc1 = hpc + 1)
head(tmp3)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    mpg cyl disp  hp drat    wt  qsec vs am gear carb hpc hpc1
## 1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4  18   19
## 2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4  18   19
## 3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1  23   24
## 4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1  18   19
## 5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2  22   23
## 6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1  18   19&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;What is the difference between &lt;code&gt;transform&lt;/code&gt; and &lt;code&gt;within&lt;/code&gt; &lt;a href=&#34;https://stackoverflow.com/a/22417775&#34;&gt;Stack Overflow&lt;/a&gt;&lt;a href=&#34;#fnref1&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn2&#34;&gt;&lt;p&gt;&lt;a href=&#34;http://rstudio-pubs-static.s3.amazonaws.com/1053_c089bd9190624b37b1180b91d2776e10.html&#34;&gt;Data manipulation using transform(), within(), or plyr::mutate()&lt;/a&gt;&lt;a href=&#34;#fnref2&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Comparison: subset and filter</title>
      <link>/post/comparison-subset-and-filter/</link>
      <pubDate>Fri, 23 Mar 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/comparison-subset-and-filter/</guid>
      <description>&lt;p&gt;A detailed &lt;a href=&#34;http://adv-r.had.co.nz/Subsetting.html&#34;&gt;introduction&lt;/a&gt; on &lt;code&gt;subsetting&lt;/code&gt; is seen in Hadley Wickham’s &lt;strong&gt;Advanced R&lt;/strong&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;The three subsetting operators.&lt;/li&gt;
&lt;li&gt;The six types of subsetting.&lt;/li&gt;
&lt;li&gt;Important differences in behaviour for different objects (e.g., vectors, lists, factors, matrices, and data frames).&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://stackoverflow.com/users/1017276/benjamin&#34;&gt;Benjamin&lt;/a&gt; on &lt;a href=&#34;https://stackoverflow.com/a/39882777&#34;&gt;Stack Overflow&lt;/a&gt; answered the question &lt;a href=&#34;#fn1&#34; class=&#34;footnoteRef&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; of the comparison between &lt;code&gt;subset()&lt;/code&gt; and &lt;code&gt;dplyr::filter()&lt;/code&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;They are, indeed, producing the same result, and they are very similar in concept.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;As the data sets grow, &lt;code&gt;filter&lt;/code&gt; seems gains the upper hand in efficiency.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;The use of subsetting in conjunction with assignment. &lt;a href=&#34;https://stackoverflow.com/a/39882777&#34;&gt;Stack Overflow&lt;/a&gt;&lt;a href=&#34;#fnref1&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>From NCL to R</title>
      <link>/post/from-ncl-to-r/</link>
      <pubDate>Fri, 16 Mar 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/from-ncl-to-r/</guid>
      <description>&lt;p&gt;From the point of atmospheric science, NCL has certain natural advantages in dealing with self-described meteorological data formats, but R is improving significantly.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Unformated Binary&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;I have to say both NCL and R are not as good at reading/writing binary files as Fotran, though technically they are able to do the job.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Self-decribed Binary&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;NCL uses a single function &lt;code&gt;addfile&lt;/code&gt; to handle all format (netCDF, HDF, GRIB, CCM, shapefile), while R requires additional packages.&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;NCL and R variables not only support &lt;em&gt;attributes&lt;/em&gt;, &lt;em&gt;dimension names&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;NCL defaultly supports &lt;em&gt;coordinates&lt;/em&gt; to its variables, while R does this in the &lt;code&gt;Spatial*&lt;/code&gt; classes and is more powerful in GIS.&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;For Lambert Conformal Conic (LCC), NCL variables can have 2-dimensional coordinate attributes (lat2d and lon2d), which then can be automatically plotted to a basemap in any projection, which to me is huge advantage.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;N-Dimensional Array&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;The concept of &lt;code&gt;Array&lt;/code&gt; is pretty week in R, such as &lt;em&gt;Vector&lt;/em&gt; and &lt;em&gt;Matrix&lt;/em&gt;, while multi-dimensional arrays, such like a temperature variable T(ensemble, time, lev, lat, lon), are so popular in NCL.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tabular&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;No need to verbose, &lt;code&gt;data.frame&lt;/code&gt; is what makes R what it is.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Hello World</title>
      <link>/post/hello-world/</link>
      <pubDate>Thu, 15 Mar 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/hello-world/</guid>
      <description>&lt;p&gt;I used to blog a little bit on &lt;a href=&#34;http://gzhy.blogspot.com/&#34;&gt;Blogger&lt;/a&gt; when I was in China. I have stopped blogging for a long time since the emergency of social networks. Looking back at what I wrote when I was a young college student, I couldn’t help but feel how different I am right now. I really hope I can start likeing writting things again, focusing on &lt;strong&gt;R &amp;amp; Data Science&lt;/strong&gt; from a geoscience perspective.&lt;/p&gt;
&lt;p&gt;Huge thanks for &lt;a href=&#34;https://yihui.name/en/about/&#34;&gt;Yihui Xie&lt;/a&gt; and his &lt;a href=&#34;https://github.com/rstudio/blogdown&#34;&gt;blogdown&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>West Michigan Big Data Meetup</title>
      <link>/talk/2018-meetup-big-data/</link>
      <pubDate>Thu, 01 Feb 2018 00:00:00 -0500</pubDate>
      
      <guid>/talk/2018-meetup-big-data/</guid>
      <description>&lt;p&gt;At 6 PM, Dr. Xiao will present on Big Data and Climate Modeling. Dr. Xiao works at the National Oceanic and Atmospheric Administration (NOAA) Great Lakes Environmental Research Laboratory (GLERL) in Ann Arbor. He specializes in hydro-climatology and climate change in the Great Lakes region using regional numerical climate models. As a climate modeler, Dr. Xiao deals with &amp;ldquo;Big Meteorological Data&amp;rdquo; from in-situ observation stations, buoys, radars, satellites, and mostly numerical models. He uses a sophisticated regional climate model (written in Fortran) to conduct century-scale simulations and projections (terabyte scale) of the hydroclimatology in Great Lakes region in terms of precipitation, temperature, ice coverage, river discharge, lake level, etc, with post-processing done by using analysis and visualization programming tools (e.g. NCL, R and Python). Dr. Xiao&amp;rsquo;s presentation should be an interesting source of ideas for data scientists and data analysts in other fields because climate modelers have developed and employ special methods of working with big data.&amp;rdquo;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title> Evaluating and improving modeled turbulent heat fluxes across the North American Great Lakes</title>
      <link>/publication/2018-eddy/</link>
      <pubDate>Wed, 10 Jan 2018 00:00:00 +0000</pubDate>
      
      <guid>/publication/2018-eddy/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Implementing the WRF-Hydro Modeling System in the Great Lakes Region</title>
      <link>/talk/2018-ams-austin/</link>
      <pubDate>Mon, 01 Jan 2018 00:00:00 -0500</pubDate>
      
      <guid>/talk/2018-ams-austin/</guid>
      <description>&lt;p&gt;As a physics-based, spatially-distributed hydrologic modeling system, the community Weather Research and Forecasting model (WRF) hydrological extension package (WRF-Hydro) has been used in several streamflow prediction applications in the U.S. and around the world, including the National Water Model (NWM) at the newly established NOAA National Water Center. However, because of lack of consistency of the geofabric data along the U.S. and Canada borders, the Great Lakes basin is not entirely included in NWM, leaving a substantial gap for applying the national model to the water-dominated region. Thus, a specific effort has been devoted to implementing the WRF-Hydro modeling system in the Great Lakes basin, including preparing high-resolution terrain datasets, parameterizing lakes and reservoirs, and calibrating the model. Two experiments have been carried out to support implementation of the NWM in the Great Lakes basin: an offline WRF-Hydro simulation forced by NLDAS2 and a coupled WRF/WRF-Hydro simulation. The model results are validated against observations in terms of precipitation, runoff, soil moisture, channel flow, and land surface heat fluxes. Our preliminary study presented here shows that the WRF-Hydro model is capable of reproducing the land–hydro-air feedbacks in the Great Lakes region.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Turbulent heat fluxes during an extreme lake effect snow event</title>
      <link>/publication/2017-flux/</link>
      <pubDate>Fri, 01 Dec 2017 00:00:00 +0000</pubDate>
      
      <guid>/publication/2017-flux/</guid>
      <description></description>
    </item>
    
    <item>
      <title> Improving the lake scheme within a coupled WRF-Lake model in the Laurentian Great Lakes</title>
      <link>/publication/2016-lake/</link>
      <pubDate>Thu, 22 Dec 2016 00:00:00 +0000</pubDate>
      
      <guid>/publication/2016-lake/</guid>
      <description></description>
    </item>
    
  </channel>
</rss>
